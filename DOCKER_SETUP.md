# üê≥ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É –ø—Ä–æ–µ–∫—Ç–∞ –≤ Docker

## ‚ö†Ô∏è –í–∞–∂–Ω–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å XAMPP

–ï—Å–ª–∏ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω XAMPP –∏ MySQL —É–∂–µ –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 3306, —ç—Ç–æ **–Ω–µ –ø—Ä–æ–±–ª–µ–º–∞**! 
Docker MySQL –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ—Ä—Ç **3307** –Ω–∞ –≤–∞—à–µ–π –º–∞—à–∏–Ω–µ –∏ –Ω–µ –±—É–¥–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å —Å XAMPP.

## üìã –®–∞–≥–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

### 1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `.env` —Ñ–∞–π–ª

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `.env` –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤—ã–≥–ª—è–¥—è—Ç —Ç–∞–∫:

```env
DB_CONNECTION=mysql
DB_HOST=db
DB_PORT=3306
DB_DATABASE=crm_laravel
DB_USERNAME=laravel
DB_PASSWORD=root
```

**–í–ê–ñ–ù–û:** 
- `DB_HOST=db` - —ç—Ç–æ –∏–º—è —Å–µ—Ä–≤–∏—Å–∞ –∏–∑ docker-compose.yml
- –ù–ï –º–µ–Ω—è–π—Ç–µ –Ω–∞ `localhost` –∏–ª–∏ `127.0.0.1`!
- `DB_PORT=3306` - –ø–æ—Ä—Ç –≤–Ω—É—Ç—Ä–∏ Docker (–Ω–µ –º–µ–Ω—è–π—Ç–µ!)

### 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

```bash
docker-compose up -d
```

–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞:
- –°–æ–∑–¥–∞—Å—Ç –∏ –∑–∞–ø—É—Å—Ç–∏—Ç –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (app, nginx, db, redis)
- MySQL –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É **3307** –Ω–∞ –≤–∞—à–µ–π –º–∞—à–∏–Ω–µ (–Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ—Ç —Å XAMPP)
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –Ω–∞ http://localhost:8000

### 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Composer

```bash
docker-compose exec app composer install
```

### 4. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –∫–ª—é—á –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
docker-compose exec app php artisan key:generate
```

### 5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
docker-compose exec app php artisan migrate
```

### 6. –ì–æ—Ç–æ–≤–æ! üéâ

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: **http://localhost:8000**

## üîß –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
```bash
docker-compose down
```

### –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å volumes (–û–°–¢–û–†–û–ñ–ù–û: —É–¥–∞–ª–∏—Ç –¥–∞–Ω–Ω—ã–µ –ë–î!)
```bash
docker-compose down -v
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```bash
docker-compose logs -f app
docker-compose logs -f db
docker-compose logs -f nginx
```

### –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É artisan
```bash
docker-compose exec app php artisan [–∫–æ–º–∞–Ω–¥–∞]
```

### –í–æ–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
docker-compose exec app bash
```

### –í–æ–π—Ç–∏ –≤ MySQL
```bash
docker-compose exec db mysql -u laravel -proot crm_laravel
```

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "MySQL shutdown unexpectedly"

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ XAMPP MySQL –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (–Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
2. –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—ã–µ volumes: `docker-compose down -v`
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∑–∞–Ω–æ–≤–æ: `docker-compose up -d`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose logs db`

### –ü—Ä–æ–±–ª–µ–º–∞: "Connection refused" –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ –ë–î

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ `.env` —É–∫–∞–∑–∞–Ω–æ `DB_HOST=db` (–Ω–µ localhost!)
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä db –∑–∞–ø—É—â–µ–Ω: `docker-compose ps`
3. –ü–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥ - MySQL –º–æ–∂–µ—Ç –µ—â–µ –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ healthcheck: `docker-compose ps db`

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–æ—Ä—Ç—ã –∑–∞–Ω—è—Ç—ã

**–†–µ—à–µ–Ω–∏–µ:**
- –ü–æ—Ä—Ç 8000 –∑–∞–Ω—è—Ç? –ò–∑–º–µ–Ω–∏—Ç–µ –≤ docker-compose.yml: `"8001:80"` –∏ –æ—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8001
- –ü–æ—Ä—Ç 3307 –∑–∞–Ω—è—Ç? –ò–∑–º–µ–Ω–∏—Ç–µ –≤ docker-compose.yml: `"3308:3306"` (–Ω–æ –≤ `.env` –æ—Å—Ç–∞–≤—å—Ç–µ `DB_PORT=3306`!)

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–µ—Ä–≤–∏—Å–æ–≤

- **app** - PHP 8.0 FPM –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Laravel
- **nginx** - –í–µ–±-—Å–µ—Ä–≤–µ—Ä (–ø–æ—Ä—Ç 8000 –Ω–∞ —Ö–æ—Å—Ç–µ)
- **db** - MySQL 8.0 (–ø–æ—Ä—Ç 3307 –Ω–∞ —Ö–æ—Å—Ç–µ, 3306 –≤–Ω—É—Ç—Ä–∏ Docker)
- **redis** - Redis –∫—ç—à (–ø–æ—Ä—Ç 6379)

## üí° –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **XAMPP –∏ Docker –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ** - –æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–∞–∑–Ω—ã–µ –ø–æ—Ä—Ç—ã
2. **–î–∞–Ω–Ω—ã–µ –ë–î —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è** –≤ Docker volume `db_data` - –¥–∞–∂–µ –ø–æ—Å–ª–µ `docker-compose down`
3. **–î–ª—è —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ë–î** –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `docker-compose down -v`
4. **–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ** –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —Å—Ä–∞–∑—É (volumes –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é)


